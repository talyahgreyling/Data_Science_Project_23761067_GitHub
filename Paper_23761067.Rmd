---
# ----- Output format:
title: "Grape minds think alike"
documentclass: "elsarticle"
Thesis_FP: FALSE
output:
  pdf_document:
    keep_tex: TRUE
    template: Tex/TexDefault.txt
    fig_width: 3.5 # Default figure sizes
    fig_height: 3.5

# ----- Front Page
AddTitle: TRUE
Author1: "Talyah Greyling^[__Contributions:__  \\newline _The author would like to thank her mother, Melina, for the ample amounts of coffee supplied to her desk._]" 
Ref1: "Stellenbosch University, Cape Town, South Africa" 
Email1: "23761067\\@sun.ac.za" 
CorrespAuthor_1: TRUE

# ----- Headers and footers:
BottomLFooter: Grape minds think alike                    
TopLHeader: \leftmark 
BottomRFooter: "\\footnotesize Page \\thepage"
addtoprule: TRUE
addfootrule: TRUE 

# ----- Page margins:
margin: 2.3 # Sides
bottom: 2 # Bottom
top: 2.5 # Top
HardSet_layout: TRUE 

# ----- Line numbers:
linenumbers: FALSE

# ----- References:
bibliography: Tex/ref.bib       # References location
csl: Tex/harvard-stellenbosch-university.csl # Referencing format used

# ----- General:
RemovePreprintSubmittedTo: TRUE  
toc: FALSE                      
numbersections: TRUE            # Number sections, figures and tables
fontsize: 11pt                  
linestretch: 1.2                
link-citations: TRUE            # Add dynamic links to papers in reference list

abstract: |
  *UPDATE ABSTRACT*
  * Copy table output, put in ChatGPT & ask to rewrite @Latex format, paste in Paper_23761067
  * ggsave & include_graphics("{location}tables/table1.png") for plots 
  Main research question: NLP: Which words in reviews are associated with higher wine ratings?
  * interesting sentiment/wine words/descriptives literature
  * Method: 2 step: random forrest (or lasso) - variable selector (words as columns & ratings as rows), top N words (20/50) filter only on those columns & draw word clouds, variable importance plots & PDP (Partial Dependence Plots)
  * Then run regressions of best words (OLS)
  
  Abstract to be written here. The abstract should not be too long and should provide the reader with a good understanding what you are writing about. Academic papers are not like novels where you keep the reader in suspense. To be effective in getting others to read your paper, be as open and concise about your findings here as possible. Ideally, upon reading your abstract, the reader should feel he / she must read your paper in entirety.
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE, 
                      warning = FALSE, 
                      fig.width = 6, 
                      fig.height = 5, 
                      fig.pos = 'H')
```

```{r Housekeeping, include = FALSE}

# Load necessary packages:
pacman::p_load(knitr)
               
# Set location: 
loc <- "C:/Users/Talyah Greyling/Documents/1) Meesters/1) Data Science 871/Data_Science_Project_23761067_GitHub/"

```
<!-- # References cheat sheet:  -->
<!-- # save as BibTex -->
<!-- # normal: @fama1997[p. 33] -->
<!-- # in brackets: [@grinold2000] -->
<!-- # join 2: \& -->

<!-- # reference a section: Section \ref{section.name} -->
<!-- # reference a figure: Figures \ref{Figure1} -->

\newpage
# Introduction \label{Intro}

Grape minds think alike... or do they? The objective of this study is to investigate which words (if any) used in wine reviews are associated with higher wine ratings on an online marketplace platform. The data utilised in this study is a sample drawn from Vivino ^[_follow [this link](https://www.vivino.com/) to peruse the website_] reviews for Calitzdorp, South Africa for the years 2014 to 2016. Section1 contains a review of the existing literature surrounding sentiment and, more specifically, wine descriptives. Thereafter section 2 explains how the data was cleaned and transformed and embarks on an exploratory description and analysis of the data by making use of histograms and word clouds. In section 3 statistical modelling is employed in a two-step process consisting of a RandomForest variable selection method and an OLS regression to determine which words used in wine reviews are the best predictors of good ratings. Thereafter a conclusion is drawn in section 4. 

\newpage
# Literature review \label{LitRev}

## Economic importance
The South African Wine Harvest Report (2023) lists South Africa among the top 10 largest wine producers globally, noting that the country produces approximately 4% of the global wine supply. Additionally, over R55 billion of the countryâ€™s GDP can be attributed to the wine industry which employs roughly 269 000 workers [@WoSA2023]. The Economic importance of this research question therefore lies in the ability to understanding how to boost one's ratings and thereby ultimately sales by using the correct words in reviews. This research can therefore have an impact on both the country's GDP as well as employment if the boost in ratings and income generated is significant enough. 

## Sentiment analysis 
@AliEtAl2025 describes sentiment analysis as the undertaking of determining the opinions and emotions conveyed via text and other media. This has a multitude of applications in our increasingly technologically driven society in the domains of e-commerce and marketing, social media, politics and health. With the explosion of text based content during the fourth industrial revolution, @DangEtAl2021 explain that a vast amount of opposing representations of anything ranging from facts to opinions can be found online. This gives sentiment analysis an important role to play in deciphering this new technological landscape we find ourselves in. @AlalwanEtAl2018 note that utilising data mining tools and social media analytics have indeed given businesses invaluable insight into the preferences, attitudes and behaviour of their customers. 

However, these online platforms where individuals have the freedom to write whatever and however they deem fit are equally hazardous as they can facilitate the spread of incorrect information. @VosoughiEtAl2018 found incorrect information to actually spread wider and faster on social media than its true counterpart. Nevertheless, these platforms form an integral part of sentiment analysis since they provide an ever changing source of data that is becoming more complex and connected by the day [@DangEtAl2021]. 

Vivino is predominantly an online marketplace, but can also be considered as a social media platform of sorts. The mechanics of the site's interface and features, to a large extent, mirror those of any standard social media platform. Vivino users create a profile with an accompanying profile picture and are able to follow and therefore be followed by other users. Furthermore users are able to post images alongside their wine reviews, which other users can then like, comment on or share at their own discretion. The reviews shared on Vivino are therefore subject to the same emotional and behavioural biases as social media posts which means that value can be added to understanding the inner workings of this platform's data by applying sentiment analysis techniques. 

## Wine descriptives 

\newpage
# Exploratory data description & analysis \label{Data}

## Data transformation and cleaning
* Started with 2298 observations of 107 variables 
* Extracted the 3 variables useful for my research question 
* Only English observations were kept as using APIs for translation is too costly (1667 observations remaining)
* Unnested tokens (30 800 tokens were recorded)
* I followed the standard pre-processing steps of removing punctuation, numbers, symbols, characters and taking everything to lower case
* I also used the default tidyverse stop_words dataset to remove stop words (16 869 tokens remaining) using 3 respective lexicons: snowball (from the tm package), onix (from the ONIX text retrieval system) and smart (from the SMART information retrieval system). 
* All clean tokes were used in the random forrest to avoid unnecessary sampling bias. 

## Data Exploration
* Plot rating frequency of tokens 
* Plot wordcloud of popular words

The original data set in consideration comprises 2298 observations with 107 variables.


\newpage
# Statistical modelling \label{StatMod}
* Use 2 step modelling process 
* Step 1: Use RandomForest as a variable selection method (words as columns & ratings as rows) to determine the top 20 words 
    * Plot training & testing data to confirm similar ratings distributions
    * Plot RF performance with different mtry values
    * Visualise top 20 with a variable importance plot 
    * Visualise top 50 in a wordcloud
* Step 2: run an OLS regression of the best words to get coefficients for their probability of determining good ratings

\newpage
# Conclusion \label{Concl}









\newpage
# References {-}

<div id="refs"></div>
